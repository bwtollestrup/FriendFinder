<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>FriendFinder</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.1/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
</head>
<body>
    <div class="container">

        <h2>Survey Questions</h2>
        <hr>

        <h3>
            <strong>About You</strong>
        </h3>
        <h4>Name (Required)</h4>
        <input type="text" id="name" class="form-control" required="">

        <h4>Link to Photo Image (Required)</h4>
        <input type="text" id="photo" class="form-control" required="">
        <hr>
        <div class="form-group">
            <h3>
                <strong>Question 1</strong>
            </h3>
            <h4>You like dogs.</h4>
            <label for="sel1">Select list:</label>
            <select class="form-control" id="sel1" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 2</strong>
            </h3>
            <h4>A Sunday afternoon is made for napping.</h4>
            <label for="sel2">Select list:</label>
            <select class="form-control" id="sel2" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 3</strong>
            </h3>
            <h4>You find reading to be one of your favorite past times.</h4>
            <label for="sel3">Select list:</label>
            <select class="form-control" id="sel3" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 4</strong>
            </h3>
            <h4>Wine is never optionial.</h4>
            <label for="sel4">Select list:</label>
            <select class="form-control" id="sel4" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 5</strong>
            </h3>
            <h4>You enjoy trying new things, like a different restaurant or a cooking class.</h4>
            <label for="sel5">Select list:</label>
            <select class="form-control" id="sel5" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 6</strong>
            </h3>
            <h4>Working out is something you enjoy.</h4>
            <label for="sel6">Select list:</label>
            <select class="form-control" id="sel6" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 7</strong>
            </h3>
            <h4>You enjoy social events but a night in not doing anything, is just as enjoyable.</h4>
            <label for="sel7">Select list:</label>
            <select class="form-control" id="sel7" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 8</strong>
            </h3>
            <h4>You spend time daydreaming.</h4>
            <label for="sel8">Select list:</label>
            <select class="form-control" id="sel8" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 9</strong>
            </h3>
            <h4>Travel is something you do on a regular basis.</h4>
            <label for="sel9">Select list:</label>
            <select class="form-control" id="sel9" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
            <h3>
                <strong>Question 10</strong>
            </h3>
            <h4>Family is a very important part of your life.</h4>
            <label for="sel10">Select list:</label>
            <select class="form-control" id="sel10" style="width: 150px">
                <option>--Select One--</option>
                <option>1 (Strongly Agree)</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5 (Strongly Disagree</option>
            </select>
            <br>
        </div>
        <button type="submit" class="btn btn-info btn-lg btn-block" id="submit">
            <i class="fa fa-check-circle" aria-hidden="true"></i>
            Submit</button>
        <hr>
        <footer class="footer">
                <div class="container">
                    <p class="text-center">
                        Copyright &copy; Brittany Tollestrup
                    </p>
                </div>
            </footer>
    </div>
    </div>


    <script type="text/javascript">
      
        $("#submit").on("click", function (event) {
            event.preventDefault();
            var name = $("#name").val().trim();
            if (name == "") {
                alert("Missing name");
                return;
            }

            var photo = $("#photo").val().trim();
            if (photo == "") {
                alert("Missing photo link");
                return;
            }

            var values = [];
            for (index = 1; index <= 10; index++) {
                var value = $(`#sel${index}`).val();
                values.push(parseInt(value));
            }


            var newFriend = {
                name: name,
                photo: name,
                scores: values
            };
            function compare(friend, friends) {
                var bestScore = 9999;
                var myScore = friend.scores.reduce((a, b) => a + b, 0);
                var closestFriendMatch
                for (f of friends) {
                    var friendScore = f.scores.reduce((a, b) => parseInt(a) + parseInt(b), 0);
                    var diff = Math.abs(myScore - friendScore);
                    if (diff < bestScore) {
                        closestFriendMatch = f;
                        bestScore = diff;
                    }
                }

                showBestMatchWithFriend(closestFriendMatch)
            }

            function showBestMatchWithFriend(friend) {
                console.log("hello")
                $("#match-name").text(friend.name);
                $("#match-img").attr('src', friend.photo);
                $("#results-modal").modal("show");

            }
            $.get("/api/friends")
                .then(function (data) {
                    compare(newFriend, data)
                    $.post("/api/friends", newFriend)
                        .then(function (data) {
                        });
                });
        })
    </script>
</body>

</html>